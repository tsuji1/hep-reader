# ğŸ“š EPUB/PDF Viewer

EPUBãƒ»PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–²è¦§ã§ãã‚‹ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆå‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## æ¦‚è¦

EPUBå½¢å¼ã®é›»å­æ›¸ç±ã‚’pandocã§HTMLã«å¤‰æ›ã—ã€PDFã¯pdf.jsã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã€‚å¿«é©ãªèª­æ›¸ä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚AIãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã§æœ¬ã®å†…å®¹ã«ã¤ã„ã¦è³ªå•ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### ä¸»ãªç‰¹å¾´

- ğŸ“– **EPUB/PDFå¯¾å¿œ**: EPUBã¯HTMLã«å¤‰æ›ã€PDFã¯ãã®ã¾ã¾é«˜å“è³ªè¡¨ç¤º
- ğŸŒ **Webãƒšãƒ¼ã‚¸ä¿å­˜**: URLã‚’å…¥åŠ›ã—ã¦Webè¨˜äº‹ã‚’ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ä¿å­˜
- ğŸ¤– **AIãƒãƒ£ãƒƒãƒˆ**: Gemini/Claude/OpenAIã§æœ¬ã®å†…å®¹ã«ã¤ã„ã¦è³ªå•
- ğŸ“œ **2ã¤ã®é–²è¦§ãƒ¢ãƒ¼ãƒ‰**: ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« / ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ
- ğŸ”– **ã—ãŠã‚Šæ©Ÿèƒ½**: ãƒ¡ãƒ¢ä»˜ãã§ä»»æ„ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
- ğŸ“· **ã‚¯ãƒªãƒƒãƒ—æ©Ÿèƒ½**: PDFå†…ã®ç¯„å›²ã‚’é¸æŠã—ã¦ç”»åƒã¨ã—ã¦ä¿å­˜
- ğŸ·ï¸ **ã‚¿ã‚°æ©Ÿèƒ½**: æœ¬ã‚’åˆ†é¡ãƒ»æ•´ç†ï¼ˆç©èª­ã‚¿ã‚°ç­‰ï¼‰
- ğŸ“Š **é€²æ—ä¿å­˜**: èª­ã‚“ã ä½ç½®ã‚’è‡ªå‹•ä¿å­˜ã€æ¬¡å›ç¶šãã‹ã‚‰å†é–‹
- ğŸŒ **å¤šè¨€èªå¯¾å¿œ**: è¨€èªè¨­å®šã«ã‚ˆã‚Šç¿»è¨³æ‹¡å¼µæ©Ÿèƒ½ã¨ã®é€£æºãŒå¯èƒ½
- ğŸ“± **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–**: PCãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ã‚¹ãƒãƒ›å¯¾å¿œ

## å¿…è¦ç’°å¢ƒ

- **Docker** ãŠã‚ˆã³ **Docker Compose**ï¼ˆæ¨å¥¨ï¼‰
- ã¾ãŸã¯ Node.js 20+ ã¨ pandoc

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### Dockerï¼ˆæ¨å¥¨ï¼‰

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yuzugon/epub-html-viewer.git
cd epub-html-viewer

# èµ·å‹•
docker compose up -d

# ã‚¢ã‚¯ã‚»ã‚¹
open http://localhost:10300
```

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

```bash
# pandocã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# Ubuntu/Debian
sudo apt install pandoc poppler-utils
# macOS
brew install pandoc poppler

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm run install:all

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆVite: 3000, Express: 3001ï¼‰
open http://localhost:3000
```

## ä½¿ã„æ–¹

### æ›¸ç±ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:10300 ã«ã‚¢ã‚¯ã‚»ã‚¹
2. EPUB/PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ
3. è‡ªå‹•çš„ã«å¤‰æ›ãƒ»è¿½åŠ ã•ã‚Œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«è¡¨ç¤º

### Webãƒšãƒ¼ã‚¸ã®ä¿å­˜

1. URLãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«Webãƒšãƒ¼ã‚¸ã®URLã‚’å…¥åŠ›
2. ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. æœ¬æ–‡ã¨ç”»åƒãŒæŠ½å‡ºã•ã‚Œã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§é–²è¦§å¯èƒ½ã«

### AIãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½

1. è¨­å®šç”»é¢ï¼ˆâš™ï¸ï¼‰ã§APIã‚­ãƒ¼ã‚’ç™»éŒ²ï¼ˆGemini/Claude/OpenAIï¼‰
2. ãƒªãƒ¼ãƒ€ãƒ¼ç”»é¢ã§ğŸ¤–ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ç¾åœ¨ã®ãƒšãƒ¼ã‚¸å†…å®¹ã‚’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦AIã«è³ªå•

### PDFæ©Ÿèƒ½

- **ã‚ºãƒ¼ãƒ **: ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã® +/- ãƒœã‚¿ãƒ³
- **ã‚¯ãƒªãƒƒãƒ—**: ğŸ“·ãƒœã‚¿ãƒ³ã§ç¯„å›²é¸æŠãƒ¢ãƒ¼ãƒ‰ã€ãƒ‰ãƒ©ãƒƒã‚°ã§ç”»åƒä¿å­˜
- **ãƒ†ã‚­ã‚¹ãƒˆé¸æŠ**: é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠãƒ»ã‚³ãƒ”ãƒ¼å¯èƒ½

## æŠ€è¡“ä»•æ§˜

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
Client (React/Vite:3000) â”€â”€APIâ”€â”€> Server (Express:3001) â”€â”€pandocâ”€â”€> converted/{bookId}/
         â†“ proxy                    â†“
        /api/* â†’ :3001         SQLite (data/epub-viewer.db)
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|---------|------|
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | React 18, TypeScript, Vite, React Router, pdf.js |
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | Node.js, Express.js, TypeScript |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | SQLite (better-sqlite3) |
| å¤‰æ›ã‚¨ãƒ³ã‚¸ãƒ³ | pandoc (EPUBâ†’HTML), poppler (PDF) |
| AIé€£æº | Gemini API, Claude API, OpenAI API |
| ãƒ†ã‚¹ãƒˆ | Vitest, supertest |
| ã‚³ãƒ³ãƒ†ãƒŠ | Docker, Docker Compose |

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
epub-html-viewer/
â”œâ”€â”€ client/                 # Reactãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ pages/          # Home, Reader, Settings
â”‚       â”œâ”€â”€ components/     # PdfViewer, AiChatç­‰
â”‚       â””â”€â”€ types.ts        # å‹å®šç¾©
â”œâ”€â”€ server/                 # Expressãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ index.ts            # APIã‚µãƒ¼ãƒãƒ¼
â”‚   â””â”€â”€ database.ts         # DBæ“ä½œ
â”œâ”€â”€ data/                   # SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”œâ”€â”€ converted/              # å¤‰æ›æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â””â”€â”€ package.json
```

### API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

| Method | Endpoint | èª¬æ˜ |
|--------|----------|------|
| **æ›¸ç±** |||
| POST | `/api/upload` | EPUB/PDFã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ |
| POST | `/api/save-url` | URLä¿å­˜ |
| GET | `/api/books` | æ›¸ç±ä¸€è¦§ |
| PATCH | `/api/books/:id` | æ›¸ç±æ›´æ–° |
| DELETE | `/api/books/:id` | æ›¸ç±å‰Šé™¤ |
| **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„** |||
| GET | `/api/books/:id/all-pages` | å…¨ãƒšãƒ¼ã‚¸å–å¾— |
| GET | `/api/books/:id/pdf` | PDFãƒ•ã‚¡ã‚¤ãƒ« |
| GET | `/api/books/:id/cover` | ã‚«ãƒãƒ¼ç”»åƒ |
| **ã—ãŠã‚Šãƒ»ã‚¯ãƒªãƒƒãƒ—** |||
| GET/POST | `/api/books/:id/bookmarks` | ã—ãŠã‚Š |
| GET/POST | `/api/books/:id/clips` | ã‚¯ãƒªãƒƒãƒ— |
| **ã‚¿ã‚°** |||
| GET/POST | `/api/tags` | ã‚¿ã‚°ç®¡ç† |
| GET/POST/DELETE | `/api/books/:id/tags` | æ›¸ç±ã‚¿ã‚° |
| **AI** |||
| POST | `/api/ai/chat` | AIãƒãƒ£ãƒƒãƒˆ |

## é–‹ç™º

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# ãƒ†ã‚¹ãƒˆï¼ˆã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ï¼‰
npm run test:watch

# Dockerãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤
npm test && docker compose up -d --build
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| å•é¡Œ | ç¢ºèªãƒã‚¤ãƒ³ãƒˆ |
|------|-------------|
| å¤‰æ›å¤±æ•— | `which pandoc` ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª |
| PDFè¡¨ç¤ºã•ã‚Œãªã„ | poppler-utilsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ |
| ç”»åƒéè¡¨ç¤º | `/api/books/:id/media/*` ãƒ«ãƒ¼ãƒˆç¢ºèª |
| AIå‹•ä½œã—ãªã„ | è¨­å®šç”»é¢ã§APIã‚­ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ |

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

[MIT License](LICENSE)

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è‡ªä½œã‚³ãƒ¼ãƒ‰éƒ¨åˆ†ã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§ã™ã€‚ä¾å­˜ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆReact, pdf.js, Expressç­‰ï¼‰ã¯ãã‚Œãã‚Œã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼ˆApache-2.0, ISC, BSDç­‰ï¼‰ã«å¾“ã„ã¾ã™ã€‚

## ä½œè€…

tsuji1
